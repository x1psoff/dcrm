{% extends 'base.html' %}
{% block content %}

<div class="container">
    <h1>–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è {{ record.first_name }} {{ record.last_name }}</h1>
    <p class="text-muted">ID –∑–∞–ø–∏—Å–∏: {{ record.id }}</p>

    <div class="alert alert-info">
        –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {{ success_count }} –∏–∑ {{ files_data|length }} —Ñ–∞–π–ª–æ–≤
    </div>

    {% if files_data|length == 0 %}
    <div class="alert alert-warning">
        –ù–µ—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è —ç—Ç–æ–π –∑–∞–ø–∏—Å–∏. –ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å¬ª –∑–∞–ø–∏—Å–∏, –∑–∞—Ç–µ–º –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É.
    </div>
    {% endif %}

{% if total_area %}
<div class="card mb-4 border-primary">
    <div class="card-header bg-primary text-white">
        <h5>üìä –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h6>–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å:</h6>
                <p class="h4">{{ total_area }} –º¬≤</p>
            </div>
            {% if designer_salary %}
            <div class="col-md-6">
                <h6>–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫:</h6>
                <p class="mb-1">{{ designer_info }}</p>
                <p class="h4 text-success">{{ designer_salary|floatformat:2 }} ‚ÇΩ</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}

{% for file in files_data %}
    <div class="card mb-4 {% if not file.success %}border-danger{% endif %}">
        <div class="card-header {% if not file.success %}bg-danger text-white{% endif %}">
            <h5>{{ file.file_name }}</h5>
        </div>
        <div class="card-body">
            {% if file.success %}
                <div class="row">
                    <div class="col-md-4">
                        <p><strong>–°—É–º–º–∞ –¥–ª—è 16:</strong> {{ file.sum_16 }} –º¬≤</p>
                    </div>
                    <div class="col-md-4">
                        <p><strong>–°—É–º–º–∞ –¥–ª—è 18:</strong> {{ file.sum_18 }} –º¬≤</p>
                    </div>
                    <div class="col-md-4">
                        <p><strong>–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫:</strong> {{ file.data|length }}</p>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-sm table-hover">
                        <!-- –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö -->
                    </table>
                </div>
            {% else %}
                <div class="alert alert-danger">
                    {{ file.error }}
                </div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>

{% endblock %}